# Prepare resolved radio metadata for logging
resolved_radio_meta = {
    "group_name": target_group_name,
    "answer_index": int(answer_index),
    "radio_id": radio_id,
    "radio_value": target_radio.get("value"),
    "total_options": len(target_group_radios)
}




# ---------------- STEP EXECUTION LOG : RADIO ----------------
step_counter += 1

frame_url = content_frame.url if content_frame else None

step_execution_logs.append({
    "step_order": step_counter,
    "gherkin_step": step_name,
    "step_type": "WHEN",
    "action_type": "RADIO",
    "status": "PASS",
    "error_message": None,

    # Frame details
    "frame_type": "content",
    "frame_url": frame_url,

    # Locator resolution
    "locator_strategy": "radio_group_resolution",
    "locator_value": {
        "group_name": resolved_radio_meta["group_name"],
        "answer_index": resolved_radio_meta["answer_index"],
        "radio_id": resolved_radio_meta["radio_id"],
        "radio_value": resolved_radio_meta["radio_value"],
        "total_options": resolved_radio_meta["total_options"]
    },

    # Resolved element metadata
    "resolved_element_tag": "input",
    "resolved_element_text": None,
    "resolved_element_id": resolved_radio_meta["radio_id"],
    "resolved_element_name": resolved_radio_meta["group_name"],
    "resolved_element_xpath": None,

    # Semantic input
    "input_value": f"answer={answer_index}",

    # Confidence
    "confidence": "HIGH",

    "execution_ts": datetime.now().isoformat()
})






step_counter += 1

step_execution_logs.append({
    "step_order": step_counter,
    "gherkin_step": step_name,
    "step_type": "WHEN",
    "action_type": "RADIO",
    "status": "FAIL",
    "error_message": "some error",

    "frame_type": "content",
    "frame_url": content_frame.url if content_frame else None,

    "locator_strategy": "radio_group_resolution",
    "locator_value": {
        "group_name": target_group_name if 'target_group_name' in locals() else None,
        "answer_index": answer_index
    },

    "resolved_element_tag": "input",
    "resolved_element_text": None,
    "resolved_element_id": radio_id if 'radio_id' in locals() else None,
    "resolved_element_name": target_group_name if 'target_group_name' in locals() else None,
    "resolved_element_xpath": None,

    "input_value": f"answer={answer_index}",
    "confidence": "LOW",

    "execution_ts": datetime.now().isoformat()
})

raise RuntimeError("some error")
