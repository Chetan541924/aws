When the user clicks on the link with the name = MITCHELLS OFFICES & STORAGE LLC

Then the Text 'Customer Display' is visible

Then the Text 'MITCHELLS OFFICES & STORAGE LLC' is visible

When the user selects 'Create a New Claim' from the dropdown with name = Select An Action

When the user clicks the button with name = Go

Then the Text 'Create a Claim' is visible

Then the Text 'Reference Number: New Claim' is visible

elif action_type == "SELECT":

    if "selects" not in step_name:
        raise RuntimeError("SELECT step format invalid")

    option_text = (
        step_name
        .split("selects", 1)[-1]
        .split("from", 1)[0]
        .strip()
        .strip("'\"")
        .lower()
    )

    nav_frame, content_frame = resolve_ccs_frames(page)

    # ðŸ”´ CCS-SPECIFIC: wait for customer context to finish loading
    await page.wait_for_load_state("networkidle")
    await content_frame.wait_for_timeout(2000)

    async def try_select(frame):
        # ðŸ”´ TARGET THE REAL DROPDOWN
        await frame.wait_for_selector(
            "select[name='selectAndGo']",
            timeout=15000
        )

        sel = frame.locator("select[name='selectAndGo']")
        await sel.scroll_into_view_if_needed()
        await sel.wait_for(state="visible", timeout=10000)

        options = sel.locator("option")
        count = await options.count()

        for i in range(count):
            opt = options.nth(i)
            text = (await opt.text_content() or "").lower()
            value = (await opt.get_attribute("value") or "").lower()

            if option_text in text or option_text in value:
                await sel.select_option(value=await opt.get_attribute("value"))
                return True

        return False

    # Try content frame first, then nav frame
    if not await try_select(content_frame):
        if not await try_select(nav_frame):
            raise RuntimeError(
                f"Option '{option_text}' not found in Select An Action dropdown"
            )

    logger.info(
        LogCategory.EXECUTION,
        f"[PHASE 3] SELECT successful: {option_text}"
    )

